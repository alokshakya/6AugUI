<div class="ui-g">
    <div class="ui-g-12">
        <p-tabView (onChange)="close($event)">
            <p-tabPanel header="Chapterwise Test">
                <div class="ui-g">
                    <div class="ui-g-6">
                        <p-panel header="Result">
                            <br>
                            <span class="toright"><p-checkbox [(ngModel)]="showMark" binary="true" label="include 'Mark for Review' in result"></p-checkbox></span>
                            <p-accordion (onClose)="showResult=false" [activeIndex]="activeIndex" (onOpen)="showPanel($event)">
                                <p-accordionTab *ngFor="let chapter of resultPanel();let i=index">
                                    <p-header>
                                        <div class="padtop">{{chapter.name}}</div>
                                        <div class="progress" *ngIf="showMark">
                                            <div class="progress-bar progress-bar-success" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[0]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[0]|round}}
                                            </div>
                                            <div class="progress-bar progress-bar-warning" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[1]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[1]|round}}
                                            </div>
                                            <div class="progress-bar progress-bar-danger" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[2]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[2]|round}}
                                            </div>
                                        </div>
                                        <div class="progress" *ngIf="!showMark">
                                            <div class="progress-bar progress-bar-success" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[0]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[0]|round}}
                                            </div>
                                            <div class="progress-bar progress-bar-danger" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[1]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[1]|round}}
                                            </div>
                                        </div>
                                    </p-header>
                                    <div class="ui-g" *ngFor="let test of chapter.tests;let j = index">
                                        <div class="ui-g-2 ui-sm-2" *ngIf="test?.result?.attempt_1.total_attempted_questions>0">
                                            <!-- <p-dropdown [options]="attempt" [autoWidth]="false" [(ngModel)]="selectedAttempt"></p-dropdown> -->
                                        </div>
                                        <div class="ui-g-10 ui-sm-10" *ngIf="test?.result?.attempt_1.total_attempted_questions>0">
                                            {{test.name}}
                                            <div *ngIf="showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[0]">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[0]|round}}
                                                </div>
                                                <div class="progress-bar progress-bar-warning" tooltipPosition="top" pTooltip="Marked" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[1]">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[1]|round}}
                                                </div>
                                                <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[2]">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[2]|round}}
                                                </div>
                                            </div>
                                            <div *ngIf="!showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[0]" role="progressbar">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[0]|round}}
                                                </div>
                                                <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[1]" role="progressbar">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[1]|round}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </p-accordionTab>
                            </p-accordion>
                        </p-panel>
                    </div>
                    <div class="ui-g-6" *ngIf="showResult">
                        <p-panel [toggleable]="true" (onBeforeToggle)="showResult=false" collapseIcon="fa-times" header="Result-Analysis >> {{currentChapter}}">
                            <div class="ui-g">
                                <div class="ui-g-12 container">
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Attempt</th>
                                                    <td>
                                                        <p-dropdown [options]="attempt" [style]="{'width':'100px'}" [(ngModel)]="selectedAttempt"></p-dropdown>
                                                    </td>
                                                </tr>
                                                <tr *ngFor="let data of chapter|keys">
                                                    <th>{{data.key}}</th>
                                                    <td>{{data.value}}</td>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                                <div class="ui-g-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Test Response</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <div class="ui-g">
                                                            <!-- <div class="ui-g-1 a" *ngFor="let resp of resultSummary?.result?.response;let i=index" [ngClass]="{'correct':resp.state=='correct', 'wrong':resp.state=='incorrect', 'un':resp.state=='unattempted', 'mark':resp.state=='marked'}">
                                                            {{i+1}}
                                                        </div> -->
                                                            <div class="ui-g-12">
                                                                <button md-mini-fab class="a" *ngFor="let resp of resultSummary;let i=index" [ngClass]="{'correct':resp.state=='c', 'wrong':resp.state=='i', 'un':resp.state=='u', 'mark':resp.state=='m'}"><span class="">{{i+1}}</span></button>
                                                            </div>
                                                        </div>
                                                        <div class="ui-g">
                                                            <div class="ui-g-12 nopad">Correct
                                                                <label class="chip correct"></label>
                                                            </div>
                                                            <div class="ui-g-12 nopad">Marked For Review
                                                                <label class="chip mark"></label>
                                                            </div>
                                                            <div class="ui-g-12 nopad">Wrong
                                                                <label class="chip wrong"></label>
                                                            </div>
                                                            <div class="ui-g-12 nopad">Unattempted
                                                                <label class="chip un"></label>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="ui-g-12 fluid">
                                    <!-- <button pButton (click)="display=true" label="View Detailed Result"></button> -->
                                </div>
                                <p-dialog header="{{currentChapter}} " [height]="800" [width]="1200" [(visible)]="display">
                                    <div class="ui-g">
                                        <div class="ui-g-12">
                                            <p-chart type="line" [height]="600" [width]="600" [options]="options3" [data]="dummyDataComplete"></p-chart>
                                        </div>
                                    </div>
                                </p-dialog>
                            </div>
                        </p-panel>
                    </div>
                    <div class="ui-g-6" *ngIf="!showResult">
                        <p-tabView>
                            <p-tabPanel header="3 Chapters">
                                <div class="ui-g max-height">
                                    <div class="ui-g-12">
                                        <p-chart type="bar"  [options]="options" [data]="dummyData"></p-chart>
                                    </div>
                                    <div class="ui-g-12">
                                        <p-chart type="bar"  [options]="options1" [data]="dummyData"></p-chart>
                                    </div>
                                    <div class="ui-g-12">
                                        <p-chart type="bar"  [options]="options2" [data]="dummyData"></p-chart>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="Progress">
                                <div class="ui-g">
                                    <div class="ui-g-12">
                                        <p-dropdown [options]="attemptProgress" [autoWidth]="false" [(ngModel)]="selectedAttempt"></p-dropdown>
                                        <p-dropdown [options]="testProgress" [autoWidth]="false" [(ngModel)]="selectedAttempt"></p-dropdown>

                                    </div>
                                    <div class="ui-g-12">
                                        <p-chart type="line" [data]="dummyDataProgress"></p-chart>
                                    </div>
                                </div>
                            </p-tabPanel>
<!--                             <p-tabPanel header="Tab 3">
                            </p-tabPanel>
                            <p-tabPanel header="Tab 4">
                            </p-tabPanel> -->
                        </p-tabView>
                    </div>
                </div>
            </p-tabPanel>
        </p-tabView>
    </div>
</div>