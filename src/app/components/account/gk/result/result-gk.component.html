<div class="ui-g">
    <div class="ui-g-12">
        <p-tabView (onChange)="close($event)">
            <p-tabPanel header="Chapterwise Test">
                <div class="ui-g">
                    <div class="ui-g-6">
                        <p-panel header="Result">
                            <br>
                            <span class="toright"><p-checkbox [(ngModel)]="showMark" binary="true" label="include 'Mark for Review' in result"></p-checkbox></span>
                            <p-accordion (onClose)="showResult=false" (onOpen)="showPanel($event)">
                                <p-accordionTab *ngFor="let chapter of resultPanel();let i=index">
                                    <p-header>
                                        <div class="padtop">{{chapter.name}}</div>
                                        <div class="progress" *ngIf="showMark">
                                            <div class="progress-bar progress-bar-success" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[0]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[0]|round}}
                                            </div>
                                            <div class="progress-bar progress-bar-warning" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[1]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[1]|round}}
                                            </div>
                                            <div class="progress-bar progress-bar-danger" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[2]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'])[2]|round}}
                                            </div>
                                        </div>
                                        <div class="progress" *ngIf="!showMark">
                                            <div class="progress-bar progress-bar-success" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[0]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[0]|round}}
                                            </div>
                                            <div class="progress-bar progress-bar-danger" role="progressbar" [style.width.%]="headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[1]">{{headerWidth(chapter['total_questions'],chapter['total_correct'],chapter['total_incorrect'],chapter['total_marked'],true)[1]|round}}
                                            </div>
                                        </div>
                                    </p-header>
                                    <div class="ui-g" *ngFor="let test of chapter.tests;let j = index">
                                        <div class="ui-g-12" *ngIf="test.attempted==1">
                                            <div class="ui-g">
                                                <div class="ui-g-2" *ngIf="test?.result?.attempt_1.total_attempted_questions>0"></div>
                                                <div class="ui-g-10" *ngIf="test?.result?.attempt_1.total_attempted_questions>0">
                                                    {{test.name}}
                                                    <div *ngIf="showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                        <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[0]">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[0]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-warning" tooltipPosition="top" pTooltip="Marked" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[1]">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[1]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[2]">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'])[2]|round}}
                                                        </div>
                                                    </div>
                                                    <div *ngIf="!showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                        <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[0]" role="progressbar">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[0]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" [style.width.%]="headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[1]" role="progressbar">{{headerWidth(test.result['attempt_1']['total_attempted_questions'],test.result['attempt_1']['correct'],test.result['attempt_1']['incorrect'],test.result['attempt_1']['marked'],true)[1]|round}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="ui-g-12" *ngIf="test.attempted==2">
                                            <div class="ui-g">
                                                <div class="ui-g-2" *ngIf="test?.result?.attempt_2.total_attempted_questions>0"></div>
                                                <div class="ui-g-10" *ngIf="test?.result?.attempt_2.total_attempted_questions>0">
                                                    {{test.name}}
                                                    <div *ngIf="showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                        <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'])[0]">{{headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'])[0]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-warning" tooltipPosition="top" pTooltip="Marked" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'])[1]">{{headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'])[1]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'])[2]">{{headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'])[2]|round}}
                                                        </div>
                                                    </div>
                                                    <div *ngIf="!showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                        <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" [style.width.%]="headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'],true)[0]" role="progressbar">{{headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'],true)[0]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" [style.width.%]="headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'],true)[1]" role="progressbar">{{headerWidth(test.result['attempt_2']['total_attempted_questions'],test.result['attempt_2']['correct'],test.result['attempt_2']['incorrect'],test.result['attempt_2']['marked'],true)[1]|round}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="ui-g-12" *ngIf="test.attempted==3">
                                            <div class="ui-g">
                                                <div class="ui-g-2" *ngIf="test?.result?.attempt_3.total_attempted_questions>0"></div>
                                                <div class="ui-g-10" *ngIf="test?.result?.attempt_3.total_attempted_questions>0">
                                                    {{test.name}}
                                                    <div *ngIf="showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                        <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'])[0]">{{headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'])[0]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-warning" tooltipPosition="top" pTooltip="Marked" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'])[1]">{{headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'])[1]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" role="progressbar" [style.width.%]="headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'])[2]">{{headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'])[2]|round}}
                                                        </div>
                                                    </div>
                                                    <div *ngIf="!showMark" class="progress hover" (click)="show(chapter['id'],test['id'])">
                                                        <div class="progress-bar progress-bar-success" tooltipPosition="top" pTooltip="Correct" [style.width.%]="headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'],true)[0]" role="progressbar">{{headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'],true)[0]|round}}
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" tooltipPosition="top" pTooltip="Incorrect" [style.width.%]="headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'],true)[1]" role="progressbar">{{headerWidth(test.result['attempt_3']['total_attempted_questions'],test.result['attempt_3']['correct'],test.result['attempt_3']['incorrect'],test.result['attempt_3']['marked'],true)[1]|round}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </p-accordionTab>
                            </p-accordion>
                        </p-panel>
                    </div>
                    <div class="ui-g-6" *ngIf="showResult">
                        <p-panel header="Result-Analysis >> {{currentChapter}}">
                            <div class="ui-g">
                                <div class="ui-g-12 container">
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr *ngFor="let data of chapter|keys">
                                                    <th>{{data.key}}</th>
                                                    <td>{{data.value}}</td>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                                <div class="ui-g-12">
                                    <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Test Response</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div class="ui-g">
                                                        <!-- <div class="ui-g-1 a" *ngFor="let resp of resultSummary?.result?.response;let i=index" [ngClass]="{'correct':resp.state=='correct', 'wrong':resp.state=='incorrect', 'un':resp.state=='unattempted', 'mark':resp.state=='marked'}">
                                                            {{i+1}}
                                                        </div> -->
                                                        <div class="ui-g-12">
                                                            <button md-mini-fab class="a" *ngFor="let resp of resultSummary;let i=index" [ngClass]="{'correct':resp.state=='c', 'wrong':resp.state=='i', 'un':resp.state=='u', 'mark':resp.state=='m'}"><span class="">{{i+1}}</span></button>
                                                        </div>
                                                    </div>
                                                    <div class="ui-g">
                                                        <div class="ui-g-12 nopad">Correct
                                                            <label class="chip correct"></label>
                                                        </div>
                                                        <div class="ui-g-12 nopad">Marked For Review
                                                            <label class="chip mark"></label>
                                                        </div>
                                                        <div class="ui-g-12 nopad">Wrong
                                                            <label class="chip wrong"></label>
                                                        </div>
                                                        <div class="ui-g-12 nopad">Unattempted
                                                            <label class="chip un"></label>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                </div>
                            </div>
                        </p-panel>
                    </div>
                </div>
            </p-tabPanel>
        </p-tabView>
    </div>
</div>